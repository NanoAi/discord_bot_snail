generator drizzle {
  provider = "drizzle-prisma-generator"
  output   = "../src/db/drizzle.schema.ts"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Guild {
  id       Int    @id @default(autoincrement())
  name     String
  settings Json   // Store guild settings here
  users    User[] // Relation to Users
  cases    Case[] // Relation to Cases
}

model User {
  id          Int       @id @default(autoincrement())
  guildId     Int
  username    String
  xp          Int       @default(0)
  roles       Json // Store roles in JSON format
  lastMessage DateTime?
  warnings    Int       @default(0)

  guild Guild  @relation(fields: [guildId], references: [id])
  Case  Case[]
}

model Case {
  id          Int      @id @default(autoincrement())
  guildId     Int
  userId      Int
  description String
  actions     Action[] // Relation to Actions
  tickets     Ticket[] // Relation to Tickets

  guild Guild @relation(fields: [guildId], references: [id])
  user  User  @relation(fields: [userId], references: [id])
}

model Action {
  id         Int      @id @default(autoincrement())
  caseId     Int
  actionType String // e.g., "ban", "warn", "mute"
  timestamp  DateTime @default(now())

  case Case @relation(fields: [caseId], references: [id])
}

model Ticket {
  id        Int      @id @default(autoincrement())
  caseId    Int
  issue     String
  status    String // e.g., "open", "closed"
  createdAt DateTime @default(now())

  case Case @relation(fields: [caseId], references: [id])
}
